"use strict";(globalThis["webpackChunkideahut_quasar_template"]=globalThis["webpackChunkideahut_quasar_template"]||[]).push([[162],{7162:(e,s,o)=>{o.r(s),o.d(s,{default:()=>C});var t=o(1758),a=o(8790);const l={class:"q-gutter-sm row center-items no-wrap"},r={class:"flex flex-center q-mt-xl"},i={class:"login-form text-center"},n={class:"text-h5 text-weight-bold q-pa-sm q-pb-md"};function u(e,s,o,u,d,p){const c=(0,t.g2)("q-space"),_=(0,t.g2)("q-tooltip"),h=(0,t.g2)("q-btn"),g=(0,t.g2)("q-toolbar"),b=(0,t.g2)("q-header"),m=(0,t.g2)("q-icon"),k=(0,t.g2)("q-input"),w=(0,t.g2)("q-form"),f=(0,t.g2)("q-page"),q=(0,t.g2)("q-page-container"),F=(0,t.g2)("q-layout");return(0,t.uX)(),(0,t.Wv)(F,{view:"hHh lpR fFf",class:"background-layout"},{default:(0,t.k6)((()=>[(0,t.bF)(b,{class:"header-main"},{default:(0,t.k6)((()=>[(0,t.bF)(g,null,{default:(0,t.k6)((()=>[(0,t.bF)(c),(0,t.Lk)("div",l,[(0,t.bF)(h,{round:"",icon:u.uix.dark.active()?"light_mode":"dark_mode",size:e.$q.screen.gt.sm?"md":"sm",onClick:s[0]||(s[0]=e=>u.uix.dark.toggle())},{default:(0,t.k6)((()=>[(0,t.bF)(_,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,a.v_)(u.uix.dark.active()?e.$t("label.light"):e.$t("label.dark")),1)])),_:1})])),_:1},8,["icon","size"])])])),_:1})])),_:1}),(0,t.bF)(q,null,{default:(0,t.k6)((()=>[u.is_show_login?((0,t.uX)(),(0,t.Wv)(f,{key:0},{default:(0,t.k6)((()=>[(0,t.Lk)("div",r,[(0,t.Lk)("div",i,[(0,t.Lk)("div",n,(0,a.v_)(u.util.appName()),1),(0,t.bF)(w,{onSubmit:p.on_login_click},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:u.username,"onUpdate:modelValue":s[1]||(s[1]=e=>u.username=e),class:"q-mb-md",type:"text",placeholder:e.$t("label.username"),rounded:"",outlined:""},{prepend:(0,t.k6)((()=>[(0,t.bF)(m,{name:"account_box"})])),_:1},8,["modelValue","placeholder"])])),_:1},8,["onSubmit"]),(0,t.bF)(w,{onSubmit:p.on_login_click},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:u.password,"onUpdate:modelValue":s[3]||(s[3]=e=>u.password=e),class:"q-mb-md",type:u.is_show_password?"text":"password",placeholder:e.$t("label.password"),rounded:"",outlined:""},{prepend:(0,t.k6)((()=>[(0,t.bF)(m,{name:"lock"})])),append:(0,t.k6)((()=>[(0,t.bF)(m,{name:u.is_show_password?"visibility":"visibility_off",onClick:s[2]||(s[2]=e=>u.is_show_password=!u.is_show_password)},null,8,["name"])])),_:1},8,["modelValue","type","placeholder"])])),_:1},8,["onSubmit"]),(0,t.bF)(h,{"no-caps":"",ripple:"",color:"primary",onClick:p.on_login_click,loading:u.is_in_progress,label:e.$t("label.login")},null,8,["onClick","loading","label"])])])])),_:1})):(0,t.Q3)("",!0)])),_:1})])),_:1})}o(239),o(4702);var d=o(8734),p=o(9928),c=o(8916),_=o(526),h=o(8889);const g={setup(){return{util:p.Z,uix:c.L,username:(0,d.KR)(null),password:(0,d.KR)(null),is_show_login:(0,d.KR)(!1),is_in_progress:(0,d.KR)(!1),is_show_password:(0,d.KR)(!1),is_basic_auth:(0,d.KR)(!1)}},beforeCreate(){let e=this;_.F.send({path:"/check",onSuccess(s){let o=s?.headers?s.headers:{};if(p.Z.isString(o["auth-token"])){let s={token:atob(o["auth-token"]),persistent:!0,logout:!1};h.I.auth(s),e.$router.push({path:"/"})}else e.is_show_login=!0},onError(s){let o=s?.response?s.response:{};if(401===o.status){let s=o?.headers?o.headers:{};if(p.Z.isString(s["www-authenticate"])){let o=s["www-authenticate"],t=o.toLowerCase(),a=t.indexOf(" "),l="";-1!=a&&(l=t.substring(0,a)),"basic"===l?(e.is_show_login=!0,e.is_basic_auth=!0):c.L.notify(e.$t("error.unsupported_authentication_type"),o,!1)}else e.is_show_login=!0}else e.is_show_login=!0}})},methods:{on_login_click(){let e=this,s=e.username;if(!(s&&s.length>0))return c.L.error("error.required","label.username"),!1;let o=e.password;if(!(o&&o.length>0))return c.L.error("error.required","label.password"),!1;if(e.is_in_progress=!0,e.is_basic_auth){let t=s+":"+o,a={token:"Basic "+btoa(t),persistent:!0,logout:!0};h.I.auth(a),_.F.send({path:"/check",onFinish(){e.is_in_progress=!1},onSuccess(){e.$router.push({path:"/"})},onError(){c.L.error("error.invalid_authentication")}})}else _.F.call({path:"/login",method:"post",params:{username:s,password:o},onFinish(){e.is_in_progress=!1},onSuccess(s){p.Z.isString(s)&&""!==s&&(h.I.auth({token:s,persistent:!1,logout:!0}),e.$router.push({path:"/"}))}})}}};var b=o(2807),m=o(3333),k=o(133),w=o(9351),f=o(1173),q=o(9001),F=o(8151),v=o(1102),x=o(3177),y=o(1565),A=o(8020),Q=o(4609),L=o(8582),S=o.n(L);const $=(0,b.A)(g,[["render",u]]),C=$;S()(g,"components",{QLayout:m.A,QHeader:k.A,QToolbar:w.A,QSpace:f.A,QBtn:q.A,QTooltip:F.A,QPageContainer:v.A,QPage:x.A,QForm:y.A,QInput:A.A,QIcon:Q.A})}}]);